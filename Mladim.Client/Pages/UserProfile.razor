@page "/userprofile"
@attribute [Authorize]

<MudStack Spacing="4" Class="py-4">
    
    <MudStack Row Justify="Justify.SpaceBetween">
        <MudText Typo="Typo.h5">Moji podatki</MudText>

        <MudStack Row>      
            <MudToggleIconButton ToggledChanged="UpdateAccountIfEditable" Toggled="editableAccount" Icon="@Icons.Material.Filled.Edit" Color="@Color.Primary" 
                ToggledIcon="@Icons.Material.Filled.Save" ToggledColor="@Color.Primary" />

            <MudIconButton Icon="@Icons.Material.Filled.Cancel" Color="@Color.Secondary" OnClick="CancelButton"/>

         </MudStack>     
    </MudStack>
   
     <MudForm Model="appUser" @ref="@appUserForm" Validation="@(appUserValidator.ValidateValue)">
         <MudGrid Spacing="4">
         
             <MudItem sm="12" md="6">
                <MudTextField @bind-Value="appUser.Name" For="@(() => appUser.Name)" ReadOnly="@(!editableAccount)" Label="Ime" Variant="Variant.Outlined"></MudTextField>
             </MudItem>
            <MudItem sm="12" md="6">
                <MudTextField @bind-Value="appUser.Surname" For="@(() => appUser.Surname)" ReadOnly="@(!editableAccount)" Label="Priimek" Variant="Variant.Outlined"></MudTextField>
            </MudItem>

            <MudItem sm="12" md="6">
                <MudTextField @bind-Value="appUser.Nickname" For="@(() => appUser.Nickname)" ReadOnly="@(!editableAccount)" Label="Vzdevek" Variant="Variant.Outlined"></MudTextField>
            </MudItem>

            <MudItem sm="12" md="6">
                <MudTextField @bind-Value="appUser.Email" For="@(() => appUser.Email)" ReadOnly="@(!editableAccount)" Label="Email" Variant="Variant.Outlined"></MudTextField>
            </MudItem>    
         </MudGrid>

        <MudText>Sprememba gesla</MudText>

         @if (editableAccount)
         {
            <MudTextField Label="Trenutno geslo"
            @bind-Value="appUser.Password" For="@(() => appUser.Password)"
                          InputType="@PasswordInput"
                          Adornment="Adornment.End" AdornmentIcon="@PasswordInputIcon" OnAdornmentClick="ButtonPasswordClick" AdornmentAriaLabel="Pokaži geslo" />

            <MudTextField Label="Novo geslo"
            @bind-Value="appUser.NewPassword" For="@(() => appUser.NewPassword)"
                          InputType="@NewPasswordInput"
                          Adornment="Adornment.End" AdornmentIcon="@NewPasswordInputIcon" OnAdornmentClick="ButtonNewPasswordClick" AdornmentAriaLabel="Pokaži geslo"/>

            <MudTextField Label="Ponovitev novega gesla"
            @bind-Value="appUser.ConfirmedPassword" For="@(() => appUser.ConfirmedPassword)"
                          InputType="@ConfirmedPasswordInput"
                          Adornment="Adornment.End" AdornmentIcon="@ConfirmedPasswordInputIcon" OnAdornmentClick="ButtonConfirmedPasswordClick" AdornmentAriaLabel="Pokaži geslo"/>
          
         }
         else
         {
            <MudText>Za spremembe gesla klikni na ikono za urejenaje profila </MudText>
         }

     </MudForm>

</MudStack>



